groups:
- name: example_alerts
  rules:
  - alert: HighCPUUsage
    expr: node_cpu_seconds_total{mode="idle"} < 20
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "High CPU usage detected on {{ $labels.instance }}"
      description: "CPU idle time is below 20% for more than 5 minutes."
  - alert: HighMemoryUsage
    expr: node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes < 0.2
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High memory usage detected on {{ $labels.instance }}"
      description: "Available memory is less than 20% for more than 5 minutes."
  - alert: DiskSpaceLow
    expr: (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"}) < 0.15
    for: 10m
    labels:
      severity: warning
    annotations:
      summary: "Low disk space on {{ $labels.instance }}"
      description: "Disk space on root partition is below 15% for more than 10 minutes."

  - alert: MongoDBDown
    expr: mongodb_up == 0
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "MongoDB is down on {{ $labels.instance }}"
      description: "MongoDB has been down for more than 5 minutes."

  - alert: MongoDBReplicationLag
    expr: mongodb_mongod_replset_member_replication_lag > 30
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "MongoDB replication lag on {{ $labels.instance }}"
      description: "Replication lag is greater than 30 seconds for more than 5 minutes."

  - alert: RedisDown
    expr: redis_up == 0
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "Redis is down on {{ $labels.instance }}"
      description: "Redis has been down for more than 5 minutes."
